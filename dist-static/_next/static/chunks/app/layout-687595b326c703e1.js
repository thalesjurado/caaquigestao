(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{646:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1243:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},1284:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},1642:(e,t,a)=>{"use strict";a.d(t,{default:()=>x});var s=a(5155),i=a(2115),r=a(4861),l=a(1243),n=a(646),o=a(1284),c=a(9946);let d=(0,c.A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),u=(0,c.A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var h=a(4416),m=a(1702);function f(){let[e,t]=(0,i.useState)(!1),[a,c]=(0,i.useState)("notifications"),{notifications:f,unreadNotifications:x,unreadCount:p,rules:g,markAsRead:b,markAllAsRead:y,removeNotification:N,updateRule:v}=(0,m.E)();return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("button",{onClick:()=>t(!e),className:"relative p-2 rounded-lg hover:bg-gray-100 transition-colors",title:"Notifica\xe7\xf5es",children:[(0,s.jsx)(d,{className:"w-5 h-5 text-gray-600"}),p>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:p>9?"9+":p})]}),e&&(0,s.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-96 bg-white rounded-xl shadow-lg border z-50",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("h3",{className:"font-semibold",children:"Notifica\xe7\xf5es"}),p>0&&(0,s.jsxs)("span",{className:"bg-red-100 text-red-700 text-xs px-2 py-1 rounded-full",children:[p," nova",1!==p?"s":""]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>c("settings"),className:"p-1 rounded ".concat("settings"===a?"bg-gray-100":""),title:"Configura\xe7\xf5es",children:(0,s.jsx)(u,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>t(!1),className:"p-1 rounded hover:bg-gray-100",children:(0,s.jsx)(h.A,{className:"w-4 h-4"})})]})]}),(0,s.jsxs)("div",{className:"flex border-b",children:[(0,s.jsxs)("button",{onClick:()=>c("notifications"),className:"flex-1 px-4 py-2 text-sm font-medium ".concat("notifications"===a?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-800"),children:["Notifica\xe7\xf5es (",f.length,")"]}),(0,s.jsx)("button",{onClick:()=>c("settings"),className:"flex-1 px-4 py-2 text-sm font-medium ".concat("settings"===a?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-800"),children:"Configura\xe7\xf5es"})]}),(0,s.jsx)("div",{className:"max-h-96 overflow-y-auto",children:"notifications"===a?(0,s.jsxs)("div",{children:[f.length>0&&(0,s.jsx)("div",{className:"p-3 border-b bg-gray-50",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:[f.length," notifica\xe7\xe3o",1!==f.length?"\xf5es":""]}),(0,s.jsx)("div",{className:"flex gap-2",children:p>0&&(0,s.jsx)("button",{onClick:y,className:"text-xs text-blue-600 hover:text-blue-800",children:"Marcar todas como lidas"})})]})}),0===f.length?(0,s.jsxs)("div",{className:"p-8 text-center text-gray-500",children:[(0,s.jsx)(d,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),(0,s.jsx)("p",{children:"Nenhuma notifica\xe7\xe3o"}),(0,s.jsx)("p",{className:"text-sm",children:"Voc\xea est\xe1 em dia! \uD83C\uDF89"})]}):(0,s.jsx)("div",{className:"divide-y",children:f.map(e=>(0,s.jsx)("div",{className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors ".concat(e.read?"":"bg-blue-50 border-l-4 border-l-blue-500"),onClick:()=>{b(e.id),e.actionUrl&&(window.location.hash=e.actionUrl.replace("#",""),t(!1))},children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(e=>{switch(e){case"error":return(0,s.jsx)(r.A,{className:"w-5 h-5 text-red-500"});case"warning":return(0,s.jsx)(l.A,{className:"w-5 h-5 text-yellow-500"});case"success":return(0,s.jsx)(n.A,{className:"w-5 h-5 text-green-500"});default:return(0,s.jsx)(o.A,{className:"w-5 h-5 text-blue-500"})}})(e.type),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"font-medium text-sm",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500",children:(e=>{let t=new Date().getTime()-e.getTime(),a=Math.floor(t/6e4),s=Math.floor(t/36e5),i=Math.floor(t/864e5);return a<1?"Agora":a<60?"".concat(a,"m atr\xe1s"):s<24?"".concat(s,"h atr\xe1s"):"".concat(i,"d atr\xe1s")})(e.createdAt)}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),N(e.id)},className:"p-1 rounded hover:bg-gray-200",title:"Remover",children:(0,s.jsx)(h.A,{className:"w-3 h-3"})})]})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),!e.read&&(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),b(e.id)},className:"text-xs text-blue-600 hover:text-blue-800 mt-2",children:"Marcar como lida"})]})]})},e.id))})]}):(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h4",{className:"font-medium mb-4",children:"Regras de Notifica\xe7\xe3o"}),(0,s.jsx)("div",{className:"space-y-3",children:g.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h5",{className:"font-medium text-sm",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["deadline"===e.type&&"".concat(e.conditions.daysBeforeDeadline," dias antes do prazo"),"overallocation"===e.type&&"Aloca\xe7\xe3o > ".concat(e.conditions.allocationThreshold,"%"),"status_change"===e.type&&"Mudan\xe7a de status"]})]}),(0,s.jsx)("label",{className:"flex items-center",children:(0,s.jsx)("input",{type:"checkbox",checked:e.enabled,onChange:t=>v(e.id,{enabled:t.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})})]},e.id))}),(0,s.jsxs)("div",{className:"mt-6 pt-4 border-t",children:[(0,s.jsx)("h5",{className:"font-medium text-sm mb-2",children:"Configura\xe7\xf5es Gerais"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Notifica\xe7\xf5es por email"}),(0,s.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:!0})]}),(0,s.jsxs)("label",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm",children:"Sons de notifica\xe7\xe3o"}),(0,s.jsx)("input",{type:"checkbox",className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500",disabled:!0})]})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"Funcionalidades avan\xe7adas em desenvolvimento"})]})]})})]})]})}function x(){let[e,t]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{t(!0)},[]),e)?(0,s.jsx)(f,{}):null}},1702:(e,t,a)=>{"use strict";a.d(t,{E:()=>l,l:()=>r});var s=a(5749);class i{getDefaultRules(){return[{id:"deadline-7-days",name:"Prazo em 7 dias",type:"deadline",enabled:!0,conditions:{daysBeforeDeadline:7},recipients:["all"],message:"O projeto {projectName} tem prazo em 7 dias ({deadline})"},{id:"deadline-3-days",name:"Prazo em 3 dias",type:"deadline",enabled:!0,conditions:{daysBeforeDeadline:3},recipients:["all"],message:"⚠️ URGENTE: O projeto {projectName} tem prazo em 3 dias ({deadline})"},{id:"deadline-today",name:"Prazo hoje",type:"deadline",enabled:!0,conditions:{daysBeforeDeadline:0},recipients:["all"],message:"\uD83D\uDEA8 CR\xcdTICO: O projeto {projectName} tem prazo HOJE ({deadline})"},{id:"overallocation-100",name:"Sobrecarga de equipe",type:"overallocation",enabled:!0,conditions:{allocationThreshold:100},recipients:["management"],message:"⚠️ {collaboratorName} est\xe1 com aloca\xe7\xe3o acima de 100% ({percentage}%)"},{id:"project-completed",name:"Projeto conclu\xeddo",type:"status_change",enabled:!0,conditions:{statusTo:"completed"},recipients:["all"],message:"\uD83C\uDF89 Projeto {projectName} foi conclu\xeddo com sucesso!"},{id:"project-cancelled",name:"Projeto cancelado",type:"status_change",enabled:!0,conditions:{statusTo:"cancelled"},recipients:["management"],message:"❌ Projeto {projectName} foi cancelado"}]}checkDeadlines(e){let t=[],a=new Date,s=this.rules.filter(e=>"deadline"===e.type&&e.enabled);for(let i of e){if("completed"===i.status||"cancelled"===i.status)continue;let e=new Date(i.endDate),r=Math.ceil((e.getTime()-a.getTime())/864e5);for(let l of s){let s=l.conditions.daysBeforeDeadline||0;if(r===s){let n={id:"deadline-".concat(i.id,"-").concat(s),type:r<=0?"error":r<=3?"warning":"info",title:"Alerta de Prazo",message:l.message.replace("{projectName}",i.name).replace("{deadline}",e.toLocaleDateString("pt-BR")),projectId:i.id,createdAt:a,read:!1,actionUrl:"#projects"};t.push(n)}}}return t}checkOverallocation(e,t){let a=[],s=new Date,i=this.rules.filter(e=>"overallocation"===e.type&&e.enabled);for(let r of e){let e=t.filter(e=>e.collaboratorId===r.id&&new Date(e.startDate)<=s&&new Date(e.endDate)>=s).reduce((e,t)=>e+t.percentage,0);for(let t of i)if(e>(t.conditions.allocationThreshold||100)){let i={id:"overallocation-".concat(r.id),type:"warning",title:"Sobrecarga de Equipe",message:t.message.replace("{collaboratorName}",r.name).replace("{percentage}",e.toString()),collaboratorId:r.id,createdAt:s,read:!1,actionUrl:"#availability"};a.push(i)}}return a}checkStatusChanges(e,t){let a=[],s=new Date,i=this.rules.filter(e=>"status_change"===e.type&&e.enabled);for(let r of t){let t=e.find(e=>e.id===r.id);if(t&&t.status!==r.status)for(let e of i){let i=!e.conditions.statusFrom||e.conditions.statusFrom===t.status,l=!e.conditions.statusTo||e.conditions.statusTo===r.status;if(i&&l){let t={id:"status-".concat(r.id,"-").concat(r.status),type:"completed"===r.status?"success":"cancelled"===r.status?"error":"info",title:"Mudan\xe7a de Status",message:e.message.replace("{projectName}",r.name),projectId:r.id,createdAt:s,read:!1,actionUrl:"#projects"};a.push(t)}}}return a}runChecks(e,t,a,s){let i=[];for(let r of(i.push(...this.checkDeadlines(e)),i.push(...this.checkOverallocation(t,a)),s&&i.push(...this.checkStatusChanges(s,e)),i))this.notifications.some(e=>e.id===r.id)||this.addNotification(r)}addNotification(e){this.notifications.unshift(e),this.saveNotifications(),"error"===e.type?s.oR.error(e.message):"warning"===e.type?s.oR.warning(e.message):"success"===e.type&&s.oR.success(e.message)}markAsRead(e){let t=this.notifications.find(t=>t.id===e);t&&(t.read=!0,this.saveNotifications())}markAllAsRead(){this.notifications.forEach(e=>e.read=!0),this.saveNotifications()}removeNotification(e){this.notifications=this.notifications.filter(t=>t.id!==e),this.saveNotifications()}cleanupOldNotifications(){let e=new Date;e.setDate(e.getDate()-30),this.notifications=this.notifications.filter(t=>new Date(t.createdAt)>e),this.saveNotifications()}getNotifications(){return this.notifications}getUnreadNotifications(){return this.notifications.filter(e=>!e.read)}getUnreadCount(){return this.getUnreadNotifications().length}getRules(){return this.rules}updateRule(e,t){let a=this.rules.findIndex(t=>t.id===e);a>=0&&(this.rules[a]={...this.rules[a],...t},this.saveRules())}addCustomRule(e){this.rules.push(e),this.saveRules()}removeRule(e){this.rules=this.rules.filter(t=>t.id!==e),this.saveRules()}startPeriodicCheck(){this.checkInterval=setInterval(()=>{},3e5)}loadRules(){try{let e=localStorage.getItem("caaqui_notification_rules");e?this.rules=JSON.parse(e):(this.rules=this.getDefaultRules(),this.saveRules())}catch(e){this.rules=this.getDefaultRules()}}saveRules(){try{localStorage.setItem("caaqui_notification_rules",JSON.stringify(this.rules))}catch(e){console.warn("Erro ao salvar regras de notifica\xe7\xe3o:",e)}}loadNotifications(){try{let e=localStorage.getItem("caaqui_notifications");e&&(this.notifications=JSON.parse(e).map(e=>({...e,createdAt:new Date(e.createdAt)})))}catch(e){this.notifications=[]}}saveNotifications(){try{localStorage.setItem("caaqui_notifications",JSON.stringify(this.notifications))}catch(e){console.warn("Erro ao salvar notifica\xe7\xf5es:",e)}}destroy(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null)}constructor(){this.rules=[],this.notifications=[],this.checkInterval=null,this.loadRules(),this.loadNotifications(),this.startPeriodicCheck()}}let r=new i;function l(){return{notifications:r.getNotifications(),unreadNotifications:r.getUnreadNotifications(),unreadCount:r.getUnreadCount(),rules:r.getRules(),markAsRead:e=>r.markAsRead(e),markAllAsRead:()=>r.markAllAsRead(),removeNotification:e=>r.removeNotification(e),updateRule:(e,t)=>r.updateRule(e,t),addCustomRule:e=>r.addCustomRule(e),removeRule:e=>r.removeRule(e)}}},2353:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_188709",variable:"__variable_188709"}},4416:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4861:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},5749:(e,t,a)=>{"use strict";a.d(t,{P0:()=>h,Yf:()=>d,oR:()=>u,uU:()=>c});var s=a(2115);let i=new Set,r=[];function l(){i.forEach(e=>e())}function n(e){return i.add(e),()=>i.delete(e)}function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,s={id:Math.random().toString(36).slice(2)+Date.now().toString(36),message:e,type:t,duration:a};r=[...r,s],l(),a>0&&setTimeout(()=>{c(s.id)},a)}function c(e){r=r.filter(t=>t.id!==e),l()}function d(){return(0,s.useSyncExternalStore)(n,()=>r,()=>r)}let u={success:e=>o(e,"success"),error:e=>o(e,"error"),warning:e=>o(e,"warning"),info:e=>o(e,"info")},h=o},5768:(e,t,a)=>{Promise.resolve().then(a.bind(a,1642)),Promise.resolve().then(a.bind(a,6848)),Promise.resolve().then(a.t.bind(a,2353,23)),Promise.resolve().then(a.t.bind(a,7275,23)),Promise.resolve().then(a.t.bind(a,9324,23))},6848:(e,t,a)=>{"use strict";a.d(t,{default:()=>c});var s=a(5155),i=a(5749),r=a(646);let l=(0,a(9946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var n=a(1284),o=a(4416);function c(){let e=(0,i.Yf)();return 0===e.length?null:(0,s.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 rounded-lg border shadow-lg max-w-sm animate-in slide-in-from-right-full ".concat((e=>{switch(e){case"success":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"info":return"bg-blue-50 border-blue-200 text-blue-800";default:return"bg-gray-50 border-gray-200 text-gray-800"}})(e.type)),children:[(e=>{switch(e){case"success":return(0,s.jsx)(r.A,{className:"w-5 h-5 text-green-500"});case"error":return(0,s.jsx)(l,{className:"w-5 h-5 text-red-500"});case"info":return(0,s.jsx)(n.A,{className:"w-5 h-5 text-blue-500"});default:return(0,s.jsx)(n.A,{className:"w-5 h-5 text-gray-500"})}})(e.type),(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsx)("p",{className:"text-sm font-medium",children:e.message})}),(0,s.jsx)("button",{onClick:()=>(0,i.uU)(e.id),className:"text-gray-400 hover:text-gray-600",children:(0,s.jsx)(o.A,{className:"w-4 h-4"})})]},e.id))})}},7275:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_9a8899",variable:"__variable_9a8899"}},9324:()=>{},9946:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var s=a(2115);let i=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},r=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:c="",children:d,iconNode:u,...h}=e;return(0,s.createElement)("svg",{ref:t,...l,width:i,height:i,stroke:a,strokeWidth:o?24*Number(n)/Number(i):n,className:r("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"},...h},[...u.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),o=(e,t)=>{let a=(0,s.forwardRef)((a,l)=>{let{className:o,...c}=a;return(0,s.createElement)(n,{ref:l,iconNode:t,className:r("lucide-".concat(i(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),o),...c})});return a.displayName=i(e),a}}},e=>{e.O(0,[519,441,964,358],()=>e(e.s=5768)),_N_E=e.O()}]);