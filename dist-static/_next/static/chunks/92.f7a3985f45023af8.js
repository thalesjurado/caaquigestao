"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[92],{3092:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var l=s(5155),a=s(2115),i=s(2204);function n(e){let{period:t,collaborators:s,projects:i,projectAllocations:n}=e,r=(0,a.useMemo)(()=>{let e=new Date;e.getTime();let l=[],a="next30"===t,r="next365"===t,d=a?7:30,o=a?5:r?12:2;for(let t=0;t<o;t++){let s=new Date(e.getTime()+t*d*864e5),i=new Date(s.getTime()+24*d*36e5);l.push({id:t,start:s,end:i,label:a?"Sem ".concat(t+1," (").concat(s.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"}),")"):r?new Date(s.getFullYear(),s.getMonth()).toLocaleDateString("pt-BR",{month:"short",year:"numeric"}):s.toLocaleDateString("pt-BR",{month:"long",year:"numeric"})})}let c=s.map(e=>{let t=n.filter(t=>t.collaboratorId===e.id),s=l.map(e=>{let s=t.filter(t=>{let s=new Date(t.startDate),l=new Date(t.endDate);return s<=e.end&&l>=e.start}),l=s.reduce((e,t)=>e+t.percentage,0),a=s.map(e=>{let t=i.find(t=>t.id===e.projectId);return{projectId:e.projectId,projectName:(null==t?void 0:t.name)||"Projeto n\xe3o encontrado",allocation:e.percentage,client:(null==t?void 0:t.client)||"Cliente n\xe3o encontrado"}});return{periodId:e.id,totalAllocation:l,projects:a,availableAllocation:Math.max(0,100-l)}});return{collaboratorId:e.id,name:e.name,role:e.role,periods:s}});return{periods:l,timeline:c}},[t,s,i,n]);return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4",children:[(0,l.jsxs)("h3",{className:"font-semibold text-blue-800 mb-2",children:["\uD83D\uDCC5 Visualiza\xe7\xe3o Timeline - ","next30"===t?"Pr\xf3ximas 5 Semanas":"next365"===t?"Pr\xf3ximos 12 Meses":"Pr\xf3ximos 2 Meses"]}),(0,l.jsx)("p",{className:"text-sm text-blue-600",children:"Aloca\xe7\xe3o da equipe distribu\xedda ao longo do tempo selecionado"})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsx)("div",{className:"next365"===t?"min-w-[1400px]":"min-w-full",children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,l.jsx)("div",{className:"w-32 font-semibold text-gray-700 flex-shrink-0",children:"Colaborador"}),r.periods.map(e=>(0,l.jsx)("div",{className:"text-center font-medium text-gray-700 text-xs ".concat("next365"===t?"w-20 flex-shrink-0":"flex-1"),children:e.label},e.id))]}),r.timeline.map(e=>(0,l.jsxs)("div",{className:"flex gap-2 items-center py-3 border-b border-gray-100",children:[(0,l.jsxs)("div",{className:"w-32 flex-shrink-0",children:[(0,l.jsx)("div",{className:"font-medium",children:e.name}),(0,l.jsx)("div",{className:"text-sm text-gray-600",children:e.role})]}),e.periods.map(e=>{var s;return(0,l.jsxs)("div",{className:"text-center ".concat("next365"===t?"w-20 flex-shrink-0":"flex-1"),children:[(0,l.jsxs)("div",{className:"inline-block px-2 py-1 rounded-lg text-xs font-medium ".concat((s=e.totalAllocation)<=25?"bg-green-500":s<=50?"bg-blue-500":s<=75?"bg-yellow-500":"bg-red-500"," text-white ").concat("next365"===t?"w-16":"min-w-16"),children:[e.totalAllocation,"%"]}),"next365"!==t&&e.projects.length>0&&(0,l.jsx)("div",{className:"mt-2 space-y-1",children:e.projects.map(e=>(0,l.jsxs)("div",{className:"text-xs text-gray-600 bg-gray-50 rounded px-2 py-1",children:[(0,l.jsx)("div",{className:"font-medium truncate",children:e.projectName}),(0,l.jsxs)("div",{children:[e.allocation,"%"]})]},e.projectId))}),"next365"!==t&&0===e.projects.length&&(0,l.jsx)("div",{className:"mt-2 text-xs text-gray-400",children:"Dispon\xedvel"})]},e.periodId)})]},e.collaboratorId))]})})}),(0,l.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,l.jsx)("h4",{className:"font-semibold mb-3",children:"\uD83D\uDCCA Resumo por Per\xedodo"}),(0,l.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:r.periods.map(e=>{let t=r.timeline.reduce((t,s)=>{let l=s.periods.find(t=>t.periodId===e.id);return l&&(t.totalAllocation+=l.totalAllocation,t.peopleCount+=1,l.totalAllocation>=90&&(t.fullyAllocated+=1),l.availableAllocation>=25&&(t.available+=1)),t},{totalAllocation:0,peopleCount:0,fullyAllocated:0,available:0}),s=t.peopleCount>0?Math.round(t.totalAllocation/t.peopleCount):0;return(0,l.jsxs)("div",{className:"bg-white rounded-lg p-3 border",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:e.label}),(0,l.jsxs)("div",{className:"space-y-1 text-xs",children:[(0,l.jsxs)("div",{className:"font-semibold ".concat(s<=25?"text-green-700":s<=50?"text-blue-700":s<=75?"text-yellow-700":"text-red-700"),children:[s,"% utiliza\xe7\xe3o m\xe9dia"]}),(0,l.jsxs)("div",{className:"text-gray-600",children:[t.available," dispon\xedveis"]}),(0,l.jsxs)("div",{className:"text-gray-600",children:[t.fullyAllocated," totalmente alocados"]})]})]},e.id)})})]})]})}function r(){let{getTeamAvailability:e,getProjectMetrics:t,collaborators:s,projects:r,projectAllocations:d}=(0,i.C)(),[o,c]=(0,a.useState)("current"),x=(0,a.useMemo)(()=>e(),[e]),m=(0,a.useMemo)(()=>t(),[t]),h=(0,a.useMemo)(()=>{let e=new Date,t=new Date(e.getTime()+2592e6),s=new Date(e.getTime()+5184e6),l=new Date(e.getTime()+31536e6);return x.map(a=>{let i=a.projects;"next30"===o?i=a.projects.filter(s=>{let l=new Date(s.endDate);return l>=e&&l<=t}):"next60"===o?i=a.projects.filter(t=>{let l=new Date(t.endDate);return l>=e&&l<=s}):"year"===o&&(i=a.projects.filter(t=>{let s=new Date(t.endDate);return s>=e&&s<=l}));let n=i.reduce((e,t)=>e+t.allocation,0);return{...a,projects:i,totalAllocation:n,availableAllocation:Math.max(0,100-n)}})},[x,o]),p=(0,a.useMemo)(()=>{let e=s.length,t=h.filter(e=>e.totalAllocation>=90).length;return{totalPeople:e,fullyAllocated:t,available:h.filter(e=>e.availableAllocation>=25).length,activeProjects:r.filter(e=>"active"===e.status).length,utilizationRate:e>0?Math.round(h.reduce((e,t)=>e+t.totalAllocation,0)/(100*e)*100):0}},[h,s.length,r]);return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-2xl font-semibold",children:"Disponibilidade da Equipe"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Dashboard para o time comercial visualizar aloca\xe7\xe3o e disponibilidade"})]}),(0,l.jsxs)("select",{value:o,onChange:e=>c(e.target.value),className:"border rounded-lg px-3 py-2",children:[(0,l.jsx)("option",{value:"current",children:"Per\xedodo Atual"}),(0,l.jsx)("option",{value:"next30",children:"Pr\xf3ximos 30 dias"}),(0,l.jsx)("option",{value:"next60",children:"Pr\xf3ximos 60 dias"}),(0,l.jsx)("option",{value:"year",children:"Ano"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[(0,l.jsxs)("div",{className:"bg-blue-50 rounded-xl p-4",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:p.totalPeople}),(0,l.jsx)("div",{className:"text-sm text-blue-600",children:"Total de Pessoas"})]}),(0,l.jsxs)("div",{className:"bg-green-50 rounded-xl p-4",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-green-600",children:p.available}),(0,l.jsx)("div",{className:"text-sm text-green-600",children:"Dispon\xedveis (25%+)"})]}),(0,l.jsxs)("div",{className:"bg-red-50 rounded-xl p-4",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-red-600",children:p.fullyAllocated}),(0,l.jsx)("div",{className:"text-sm text-red-600",children:"Totalmente Alocados"})]}),(0,l.jsxs)("div",{className:"bg-purple-50 rounded-xl p-4",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:p.activeProjects}),(0,l.jsx)("div",{className:"text-sm text-purple-600",children:"Projetos Ativos"})]}),(0,l.jsxs)("div",{className:"bg-orange-50 rounded-xl p-4",children:[(0,l.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:[p.utilizationRate,"%"]}),(0,l.jsx)("div",{className:"text-sm text-orange-600",children:"Taxa de Utiliza\xe7\xe3o"})]})]}),("next30"===o||"next60"===o||"year"===o)&&(0,l.jsx)(n,{period:"year"===o?"next365":o,collaborators:s,projects:r,projectAllocations:d}),"current"===o&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"Aloca\xe7\xe3o por Pessoa"}),h.map(e=>{var t,s;return(0,l.jsxs)("div",{className:"bg-white border rounded-xl p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"text-lg font-medium",children:e.name}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.role})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("div",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((t=e.totalAllocation)>=90?"bg-red-100 text-red-800":t>=70?"bg-yellow-100 text-yellow-800":t>=50?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:[e.totalAllocation,"% alocado"]}),(0,l.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[e.availableAllocation,"% dispon\xedvel"]})]})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[(0,l.jsx)("span",{children:"Aloca\xe7\xe3o Atual"}),(0,l.jsxs)("span",{children:[e.totalAllocation,"%"]})]}),(0,l.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,l.jsx)("div",{className:"h-3 rounded-full transition-all duration-300 ".concat((s=e.totalAllocation)<=25?"bg-green-500":s<=50?"bg-blue-500":s<=75?"bg-yellow-500":"bg-red-500"),style:{width:"".concat(Math.min(e.totalAllocation,100),"%")}})})]}),e.projects.length>0?(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium mb-3",children:"Projetos Atuais:"}),(0,l.jsx)("div",{className:"space-y-2",children:e.projects.map(e=>(0,l.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"font-medium",children:e.projectName}),(0,l.jsxs)("div",{className:"text-sm text-gray-600",children:["Termina em: ",e.endDate.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})]})]}),(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsxs)("span",{className:"font-medium",children:[e.allocation,"%"]}),(0,l.jsx)("div",{className:"text-xs text-gray-500",children:"aloca\xe7\xe3o"})]})]},e.projectId))})]}):(0,l.jsxs)("div",{className:"text-center py-4 text-gray-500 bg-gray-50 rounded-lg",children:[(0,l.jsx)("p",{children:"Nenhum projeto ativo no per\xedodo selecionado"}),(0,l.jsx)("p",{className:"text-sm",children:"Dispon\xedvel para novos projetos"})]})]},e.collaboratorId)}),0===h.length&&(0,l.jsx)("div",{className:"text-center py-12 text-gray-500",children:(0,l.jsx)("p",{children:"Nenhum colaborador cadastrado ainda."})})]}),(0,l.jsxs)("div",{className:"bg-white border rounded-xl p-6",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Resumo de Projetos Ativos"}),r.filter(e=>"active"===e.status).length>0?(0,l.jsx)("div",{className:"grid gap-4",children:r.filter(e=>"active"===e.status).map(e=>{var t;return m.find(t=>t.id===e.id),(0,l.jsxs)("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-medium",children:e.name}),(0,l.jsxs)("p",{className:"text-sm text-gray-600",children:[e.client," • ",e.type]})]}),(0,l.jsx)("div",{className:"text-right",children:(0,l.jsxs)("div",{className:"flex gap-4 text-sm",children:[(0,l.jsxs)("span",{children:[(0,l.jsx)("strong",{children:(null==(t=e.allocations)?void 0:t.length)||0})," pessoas"]}),(0,l.jsxs)("span",{children:[(0,l.jsx)("strong",{children:"0%"})," conclu\xeddo"]}),(0,l.jsxs)("span",{className:"text-green-600",children:[(0,l.jsx)("strong",{children:Math.ceil((e.endDate.getTime()-new Date().getTime())/864e5)})," dias restantes"]})]})})]},e.id)})}):(0,l.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,l.jsx)("p",{children:"Nenhum projeto ativo no momento"})})]}),(0,l.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,l.jsx)("h3",{className:"font-medium mb-3",children:"Legenda de Cores:"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 bg-green-500 rounded"}),(0,l.jsx)("span",{children:"0-25% (Muito Dispon\xedvel)"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded"}),(0,l.jsx)("span",{children:"26-50% (Dispon\xedvel)"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 bg-yellow-500 rounded"}),(0,l.jsx)("span",{children:"51-75% (Ocupado)"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-4 h-4 bg-red-500 rounded"}),(0,l.jsx)("span",{children:"76-100% (Totalmente Alocado)"})]})]})]})]})}}}]);