"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[545],{7545:(e,a,t)=>{t.d(a,{A:()=>c});var l=t(5155),r=t(2115),o=t(2204),s=t(5749);let n=[{value:"tech_implementation",label:"Tech Implementation",color:"bg-blue-100 text-blue-800"},{value:"growth_agency",label:"Growth/Agency",color:"bg-green-100 text-green-800"}],d=[{value:"planning",label:"Planejamento",color:"bg-gray-100 text-gray-800"},{value:"active",label:"Ativo",color:"bg-blue-100 text-blue-800"},{value:"on_hold",label:"Em Pausa",color:"bg-yellow-100 text-yellow-800"},{value:"completed",label:"Conclu\xeddo",color:"bg-green-100 text-green-800"},{value:"cancelled",label:"Cancelado",color:"bg-red-100 text-red-800"}];function c(e){let{isOpen:a,onClose:t,editingProject:c,onSuccess:i}=e,{addProject:p,updateProject:u,collaborators:g,addProjectAllocation:m,updateProjectAllocation:h,deleteProjectAllocation:v,projectAllocations:x}=(0,o.C)(),[b,y]=(0,r.useState)({name:"",client:"",type:"tech_implementation",status:"planning",startDate:"",endDate:"",description:"",budget:"",sdkType:"",cdpIntegration:"",martechTools:"",crmPlatform:"",campaignType:"",expectedResults:""}),[j,f]=(0,r.useState)([]),N=()=>{y({name:"",client:"",type:"tech",status:"planning",startDate:"",endDate:"",description:"",budget:"",sdkType:"",cdpIntegration:"",martechTools:"",crmPlatform:"",campaignType:"",expectedResults:""}),f([])};(0,r.useEffect)(()=>{if(c){var e,a,t,l,r,o,s,n;y({name:c.name,client:c.client,type:c.type,status:c.status,startDate:c.startDate.toISOString().split("T")[0],endDate:c.endDate.toISOString().split("T")[0],description:c.description||"",budget:(null==(e=c.budget)?void 0:e.toString())||"",sdkType:(null==(a=c.techDetails)?void 0:a.platform)||"",cdpIntegration:(null==(t=c.techDetails)?void 0:t.cdpIntegration)||"",martechTools:(null==(r=c.techDetails)||null==(l=r.martechTools)?void 0:l.join(", "))||"",crmPlatform:(null==(o=c.growthDetails)?void 0:o.crmPlatform)||"",campaignType:(null==(s=c.growthDetails)?void 0:s.campaignType)||"",expectedResults:(null==(n=c.growthDetails)?void 0:n.expectedResults)||""}),f(x.filter(e=>e.projectId===c.id).map(e=>({collaboratorId:e.collaboratorId,percentage:e.percentage,role:e.role})))}else N()},[c,x]);let D=()=>{N(),t()},w=(e,a,t)=>{let l=[...j];l[e]={...l[e],[a]:t},f(l)},C=async()=>{if(!b.name||!b.client||!b.startDate||!b.endDate)return void s.oR.error("Preencha todos os campos obrigat\xf3rios");let e=(()=>{let e=new Map;for(let[a,t]of(j.forEach(a=>{if(a.collaboratorId&&a.percentage>0){let t=e.get(a.collaboratorId)||0;e.set(a.collaboratorId,t+a.percentage)}}),e))if(t>100){let e=g.find(e=>e.id===a);return"".concat(null==e?void 0:e.name," tem ").concat(t,"% de aloca\xe7\xe3o total, excedendo 100%")}return null})();if(e)return void s.oR.error(e);let a={name:b.name,client:b.client,type:b.type,status:b.status,startDate:new Date(b.startDate),endDate:new Date(b.endDate),description:b.description||void 0,budget:b.budget?parseFloat(b.budget):void 0,techDetails:"tech"===b.type?{platform:b.sdkType,cdpIntegration:b.cdpIntegration,martechTools:b.martechTools?b.martechTools.split(",").map(e=>e.trim()):void 0}:void 0,growthDetails:"growth"===b.type?{crmPlatform:b.crmPlatform||void 0,campaignType:b.campaignType||void 0,expectedResults:b.expectedResults||void 0}:void 0};try{let e;if(c)for(let t of(await u(c.id,a),e=c.id,s.oR.success("Projeto atualizado com sucesso!"),x.filter(e=>e.projectId===c.id)))await v(t.id);else await p(a),e="".concat(b.name.replace(/\s+/g,"-").toLowerCase(),"-").concat(Date.now()),s.oR.success("Projeto criado com sucesso!");for(let a of j)a.collaboratorId&&a.percentage>0&&await m({projectId:e,collaboratorId:a.collaboratorId,percentage:a.percentage,role:a.role||"",startDate:new Date(b.startDate),endDate:new Date(b.endDate)});D(),null==i||i()}catch(e){console.error("Erro ao salvar projeto:",e),s.oR.error("Erro ao salvar projeto")}};return a?(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-4",children:c?"Editar Projeto":"Novo Projeto"}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsx)("input",{type:"text",placeholder:"Nome do projeto *",value:b.name,onChange:e=>y({...b,name:e.target.value}),className:"border rounded-lg p-3"}),(0,l.jsx)("input",{type:"text",placeholder:"Cliente *",value:b.client,onChange:e=>y({...b,client:e.target.value}),className:"border rounded-lg p-3"})]}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsx)("select",{value:b.type,onChange:e=>y({...b,type:e.target.value}),className:"border rounded-lg p-3",children:n.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,l.jsx)("select",{value:b.status,onChange:e=>y({...b,status:e.target.value}),className:"border rounded-lg p-3",children:d.map(e=>(0,l.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsx)("input",{type:"date",placeholder:"Data de in\xedcio *",value:b.startDate,onChange:e=>y({...b,startDate:e.target.value}),className:"border rounded-lg p-3"}),(0,l.jsx)("input",{type:"date",placeholder:"Data de fim *",value:b.endDate,onChange:e=>y({...b,endDate:e.target.value}),className:"border rounded-lg p-3"})]}),(0,l.jsx)("textarea",{placeholder:"Descri\xe7\xe3o",value:b.description,onChange:e=>y({...b,description:e.target.value}),className:"w-full border rounded-lg p-3",rows:3}),(0,l.jsx)("input",{type:"number",placeholder:"Or\xe7amento (R$)",value:b.budget,onChange:e=>y({...b,budget:e.target.value}),className:"w-full border rounded-lg p-3"}),(0,l.jsxs)("div",{className:"border-t pt-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h4",{className:"font-medium text-gray-700",children:"Aloca\xe7\xe3o de Equipe"}),(0,l.jsx)("button",{type:"button",onClick:()=>{f([...j,{collaboratorId:"",percentage:0}])},className:"text-blue-600 hover:text-blue-800 text-sm",children:"+ Adicionar membro"})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[j.map((e,a)=>(0,l.jsxs)("div",{className:"grid grid-cols-12 gap-3 items-center",children:[(0,l.jsxs)("select",{value:e.collaboratorId,onChange:e=>w(a,"collaboratorId",e.target.value),className:"col-span-4 border rounded-lg p-2",children:[(0,l.jsx)("option",{value:"",children:"Selecionar pessoa"}),g.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,l.jsx)("input",{type:"number",min:"0",max:"100",placeholder:"% Esfor\xe7o",value:e.percentage,onChange:e=>w(a,"percentage",parseInt(e.target.value)||0),className:"col-span-2 border rounded-lg p-2"}),(0,l.jsx)("input",{type:"text",placeholder:"Fun\xe7\xe3o (opcional)",value:e.role||"",onChange:e=>w(a,"role",e.target.value),className:"col-span-5 border rounded-lg p-2"}),(0,l.jsx)("button",{type:"button",onClick:()=>{f(j.filter((e,t)=>t!==a))},className:"col-span-1 text-red-600 hover:text-red-800",children:"\xd7"})]},a)),0===j.length&&(0,l.jsx)("div",{className:"text-sm text-gray-500 text-center py-4",children:'Nenhum membro alocado ainda. Clique em "Adicionar membro" para come\xe7ar.'})]})]}),"tech"===b.type&&(0,l.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,l.jsx)("h4",{className:"font-medium text-gray-700",children:"Detalhes T\xe9cnicos"}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsx)("input",{type:"text",placeholder:"Plataforma",value:b.sdkType,onChange:e=>y({...b,sdkType:e.target.value}),className:"border rounded-lg p-3"}),(0,l.jsx)("input",{type:"text",placeholder:"Integra\xe7\xe3o CDP",value:b.cdpIntegration,onChange:e=>y({...b,cdpIntegration:e.target.value}),className:"border rounded-lg p-3"})]}),(0,l.jsx)("input",{type:"text",placeholder:"Ferramentas Martech (separadas por v\xedrgula)",value:b.martechTools,onChange:e=>y({...b,martechTools:e.target.value}),className:"w-full border rounded-lg p-3"})]}),"growth"===b.type&&(0,l.jsxs)("div",{className:"space-y-4 border-t pt-4",children:[(0,l.jsx)("h4",{className:"font-medium text-gray-700",children:"Detalhes de Growth"}),(0,l.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,l.jsx)("input",{type:"text",placeholder:"Plataforma CRM",value:b.crmPlatform,onChange:e=>y({...b,crmPlatform:e.target.value}),className:"border rounded-lg p-3"}),(0,l.jsx)("input",{type:"text",placeholder:"Tipo de Campanha",value:b.campaignType,onChange:e=>y({...b,campaignType:e.target.value}),className:"border rounded-lg p-3"})]}),(0,l.jsx)("textarea",{placeholder:"Resultados Esperados",value:b.expectedResults,onChange:e=>y({...b,expectedResults:e.target.value}),className:"w-full border rounded-lg p-3",rows:3})]})]}),(0,l.jsxs)("div",{className:"flex gap-3 justify-end mt-6",children:[(0,l.jsx)("button",{onClick:D,className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancelar"}),(0,l.jsxs)("button",{onClick:C,className:"px-4 py-2 bg-black text-white rounded-lg hover:bg-gray-800",children:[c?"Atualizar":"Criar"," Projeto"]})]})]})}):null}}}]);