"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[207],{4207:(e,a,r)=>{r.r(a),r.d(a,{default:()=>p});var t=r(5155),o=r(2115),l=r(2204),s=r(5749);let n={dashboard:["management","executive"],projects:["management","executive"],board:["operations","management","executive"],team:["management","executive"],availability:["operations","management","executive"],timeline:["operations","management","executive"],okrs:["operations","management","executive"],rituais:["operations","management","executive"],viewHourlyRates:["executive"],editHourlyRates:["executive"],viewProjectCosts:["management","executive"],managePermissions:["executive"]},i={Desenvolvedor:"operations",Designer:"operations",Analista:"operations",Estagiário:"operations",Junior:"operations",QA:"operations",Especialista:"operations","Tech Lead":"management",Gerente:"management",Head:"management",Coordenador:"management",Senior:"management",CSM:"management",Sócio:"executive",CEO:"executive",CTO:"executive",Diretor:"executive"};function c(e,a){return n[a].includes(e)}function d(e){if(i[e])return i[e];let a=e.toLowerCase();return a.includes("s\xf3cio")||a.includes("ceo")||a.includes("cto")||a.includes("diretor")?"executive":a.includes("head")||a.includes("gerente")||a.includes("lead")||a.includes("coordenador")||a.includes("senior")?"management":"operations"}let u={operations:"Time de Opera\xe7\xf5es",management:"Ger\xeancia/Heads",executive:"S\xf3cios/Diretoria"},m=["Desenvolvedor","Desenvolvedor Senior","Tech Lead","Designer","Designer Senior","Analista","Analista Senior","QA","CSM","Especialista","Gerente","Head de Tecnologia","Head de Growth","Coordenador","S\xf3cio","CEO","CTO","Diretor","Estagi\xe1rio"];function x(e){var a,r,n,i,x;let{c:p,count:g,currentUserAccessLevel:h}=e,v=(0,l.C)(e=>e.updateCollaborator),b=(0,l.C)(e=>e.deleteCollaborator),[y,j]=(0,o.useState)(!1),[C,N]=(0,o.useState)(p.name),[f,S]=(0,o.useState)(null!=(r=p.role)?r:""),[w,R]=(0,o.useState)(null!=(n=p.email)?n:""),[k,E]=(0,o.useState)(null!=(i=p.position)?i:""),[A,D]=(0,o.useState)(null!=(x=null==(a=p.hourlyRate)?void 0:a.toString())?x:""),H=c(h,"viewHourlyRates"),L=c(h,"editHourlyRates");return(0,t.jsxs)("li",{className:"border rounded-2xl p-4 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[y?(0,t.jsxs)("div",{className:"flex-1 grid md:grid-cols-2 lg:grid-cols-4 gap-2",children:[(0,t.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Nome *",value:C,onChange:e=>N(e.target.value)}),(0,t.jsxs)("select",{className:"border rounded-xl px-3 py-2",value:k,onChange:e=>E(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Selecione o cargo *"}),m.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Email (opcional)",value:w,onChange:e=>R(e.target.value)}),L&&(0,t.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Valor/hora (R$)",type:"number",min:"0",step:"0.01",value:A,onChange:e=>D(e.target.value)})]}):(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("div",{className:"font-medium",children:p.name}),(0,t.jsxs)("span",{className:"text-xs px-2 py-0.5 rounded-full border",children:[g," atividade",1===g?"":"s"]}),(0,t.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat("executive"===p.accessLevel?"bg-purple-100 text-purple-800":"management"===p.accessLevel?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:u[p.accessLevel]})]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:p.position||"Cargo n\xe3o definido"}),p.email&&(0,t.jsx)("div",{className:"text-sm text-gray-600",children:p.email}),H&&p.hourlyRate&&(0,t.jsxs)("div",{className:"text-sm text-green-600 font-medium",children:["R$ ",p.hourlyRate.toFixed(2),"/hora"]})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"px-3 py-2 rounded-xl bg-black text-white",onClick:()=>{if(!C.trim()||!k.trim())return;let e=d(k),a={name:C,role:f,email:w,position:k,accessLevel:e};if(L&&A.trim()){let e=parseFloat(A);!isNaN(e)&&e>0&&(a.hourlyRate=e)}v(p.id,a),s.oR.success("Colaborador atualizado"),j(!1)},children:"Salvar"}),(0,t.jsx)("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>j(!1),children:"Cancelar"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{className:"px-3 py-2 rounded-xl border",onClick:()=>j(!0),children:"Editar"}),(0,t.jsx)("button",{className:"px-3 py-2 rounded-xl bg-red-600 text-white",onClick:()=>{let e=g>0?"Remover ".concat(p.name,"? ").concat(g," atividade(s) atribu\xedda(s) a ele(a) ser\xe3o DESASSOCIADAS."):"Remover ".concat(p.name,"?");window.confirm(e)&&(b(p.id),s.oR.success("Colaborador removido"))},title:"Remover colaborador",children:"Remover"})]})})]})}function p(){let e=(0,l.C)(e=>e.collaborators),a=(0,l.C)(e=>e.addCollaborator),r=(0,l.C)(e=>e.okrs),n=(0,l.C)(e=>e.loadAllData),i=(0,l.C)(e=>e.setCollaborators),u=(0,o.useMemo)(()=>{let e=new Map;return r.forEach(a=>a.activities.forEach(a=>{a.assigneeId&&e.set(a.assigneeId,(e.get(a.assigneeId)||0)+1)})),e},[r]),[p,g]=(0,o.useState)(""),[h,v]=(0,o.useState)(""),[b,y]=(0,o.useState)(""),[j,C]=(0,o.useState)(""),N="executive",f=!!p.trim()&&!!h.trim(),S=c(N,"editHourlyRates"),w=()=>{if(!f)return;let e=d(h),r={name:p.trim(),role:h.trim(),email:b.trim()||"",position:h.trim(),accessLevel:e};if(S&&j.trim()){let e=parseFloat(j);!isNaN(e)&&e>0&&(r.hourlyRate=e)}a(r),s.oR.success("Colaborador adicionado"),g(""),v(""),y(""),C("")},R=new URLSearchParams(window.location.search).has("debug"),[k,E]=(0,o.useState)(""),A=()=>{try{let e=localStorage.getItem("caaqui_collaborators");if(!e)return;let a=JSON.parse(e),r=Array.isArray(null==a?void 0:a.data)?a.data:[];Array.isArray(r)&&i(r)}catch(e){}};return(0,o.useEffect)(()=>{0===e.length&&A()},[e.length]),(0,t.jsxs)("section",{className:"space-y-4",children:[R&&(0,t.jsxs)("div",{className:"text-xs text-gray-600 flex flex-col gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsxs)("span",{className:"px-2 py-1 rounded-full border",children:["Total colaboradores: ",e.length]}),(0,t.jsx)("button",{className:"px-2 py-1 rounded border",onClick:()=>n(),title:"Recarregar dados do armazenamento/local/Supabase",children:"Recarregar dados"}),(0,t.jsx)("button",{className:"px-2 py-1 rounded border",onClick:()=>{try{let e=localStorage.getItem("caaqui_collaborators");E(e||"(vazio)")}catch(e){E("(erro ao ler localStorage)")}},title:"Ler localStorage (caaqui_collaborators)",children:"Ver localStorage"}),(0,t.jsx)("button",{className:"px-2 py-1 rounded border",onClick:A,title:"For\xe7ar carregar do localStorage para o estado",children:"For\xe7ar carregar do local"})]}),k&&(0,t.jsx)("pre",{className:"mt-1 max-h-40 overflow-auto bg-gray-50 p-2 rounded border text-[10px] whitespace-pre-wrap break-all",children:k})]}),(0,t.jsxs)("header",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-2",children:[(0,t.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Nome do colaborador *",value:p,onChange:e=>g(e.target.value),onKeyDown:e=>"Enter"===e.key&&w()}),(0,t.jsxs)("select",{className:"border rounded-xl px-3 py-2",value:h,onChange:e=>v(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Selecione o cargo *"}),m.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Email (opcional)",value:b,onChange:e=>y(e.target.value),onKeyDown:e=>"Enter"===e.key&&w()}),S&&(0,t.jsx)("input",{className:"border rounded-xl px-3 py-2",placeholder:"Valor/hora (R$)",type:"number",min:"0",step:"0.01",value:j,onChange:e=>C(e.target.value),onKeyDown:e=>"Enter"===e.key&&w()}),(0,t.jsx)("button",{className:"px-4 py-2 rounded-xl bg-black text-white disabled:opacity-50",onClick:w,disabled:!f,children:"Adicionar"})]}),(0,t.jsxs)("ul",{className:"space-y-3",children:[e.map(e=>(0,t.jsx)(x,{c:e,count:u.get(e.id)||0,currentUserAccessLevel:N},e.id)),0===e.length&&(0,t.jsx)("li",{className:"text-sm text-gray-500",children:"Nenhum colaborador ainda — adicione acima."})]})]})}}}]);