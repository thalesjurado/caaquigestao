"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[106],{8106:(e,s,t)=>{t.r(s),t.d(s,{default:()=>y});var a=t(5155),r=t(2115),i=t(2204),l=t(3540),n=t(3504),d=t(4754),o=t(6025),c=t(2071),m=t(4021),x=t(2366),h=t(3401),u=t(3329),j=t(1243),g=t(4186),p=t(646);function N(){let{projects:e,boardActivities:s}=(0,i.C)(),t=(0,r.useMemo)(()=>{let t=new Date,a=[];return e.forEach(e=>{let r=Math.ceil((e.endDate.getTime()-t.getTime())/864e5);r<0&&"active"===e.status?a.push({id:"overdue-".concat(e.id),type:"overdue",title:"Projeto Atrasado",message:"".concat(e.name," est\xe1 ").concat(Math.abs(r)," dias em atraso"),projectId:e.id,projectName:e.name,priority:"high",daysUntilDue:r}):r>0&&r<=7&&"active"===e.status&&a.push({id:"due-soon-".concat(e.id),type:"due_soon",title:"Prazo Pr\xf3ximo",message:"".concat(e.name," termina em ").concat(r," dias"),projectId:e.id,projectName:e.name,priority:r<=3?"high":"medium",daysUntilDue:r});let i=s.filter(s=>s.projectId===e.id),l=i.filter(e=>"done"===e.status).length,n=i.length>0?l/i.length*100:0;r>0&&r<=14&&n<50&&"active"===e.status&&a.push({id:"low-progress-".concat(e.id),type:"milestone",title:"Progresso Baixo",message:"".concat(e.name," tem apenas ").concat(Math.round(n),"% de progresso com ").concat(r," dias restantes"),projectId:e.id,projectName:e.name,priority:"medium"})}),a.sort((e,s)=>{let t={high:3,medium:2,low:1};return t[s.priority]-t[e.priority]})},[e,s]);return 0===t.length?(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(p.A,{className:"w-5 h-5 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium text-green-800",children:"Tudo em dia!"}),(0,a.jsx)("p",{className:"text-sm text-green-600",children:"N\xe3o h\xe1 notifica\xe7\xf5es urgentes no momento."})]})]})}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h3",{className:"font-medium text-gray-900",children:"Notifica\xe7\xf5es de Projetos"}),t.map(e=>(0,a.jsx)("div",{className:"border rounded-xl p-4 ".concat((e=>{switch(e){case"high":return"bg-red-50 border-red-200";case"medium":return"bg-yellow-50 border-yellow-200";case"low":return"bg-blue-50 border-blue-200"}})(e.priority)),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(e=>{switch(e){case"overdue":return(0,a.jsx)(j.A,{className:"w-5 h-5 text-red-500"});case"due_soon":return(0,a.jsx)(g.A,{className:"w-5 h-5 text-yellow-500"});case"milestone":return(0,a.jsx)(p.A,{className:"w-5 h-5 text-blue-500"})}})(e.type),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:["Projeto: ",e.projectName]}),(0,a.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs ".concat("high"===e.priority?"bg-red-100 text-red-700":"medium"===e.priority?"bg-yellow-100 text-yellow-700":"bg-blue-100 text-blue-700"),children:"high"===e.priority?"Alta":"medium"===e.priority?"M\xe9dia":"Baixa"})]})]})]})},e.id))]})}function v(e){let{title:s,value:t,subtitle:r}=e;return(0,a.jsxs)("div",{className:"rounded-2xl border p-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:s}),(0,a.jsx)("div",{className:"text-2xl font-semibold",children:t}),r&&(0,a.jsx)("div",{className:"text-xs text-gray-500",children:r})]})}function y(){let{boardActivities:e,okrs:s,collaborators:t,projects:j,getProjectMetrics:g}=(0,i.C)(e=>({boardActivities:e.boardActivities,okrs:e.okrs,collaborators:e.collaborators,projects:e.projects,getProjectMetrics:e.getProjectMetrics}));(0,r.useEffect)(()=>{},[e,j]);let p=e.filter(e=>"done"===e.status).length,y=e.length,b=(0,r.useMemo)(()=>g(),[g]),f=(0,r.useMemo)(()=>j.filter(e=>"active"===e.status).length,[j]),w=(0,r.useMemo)(()=>0===b.length?100:Math.round(b.filter(e=>e.isOnTime).length/b.length*100),[b]),M=(0,r.useMemo)(()=>0===b.length?0:Math.round(b.filter(e=>!e.isOnTime||e.daysRemaining<0).length/b.length*100),[b]),P=(0,r.useMemo)(()=>{let s=[],t=new Date;for(let a=4;a>=0;a--){let r=new Date(t.getTime()-7*a*864e5),i=new Date(r.getTime()+6048e5),l=e.filter(e=>{if(!e.createdAt||"done"!==e.status)return!1;let s=new Date(e.createdAt);return s>=r&&s<i}),n=0===a?"Esta":"Sem-".concat(a),d=l.reduce((e,s)=>e+(s.points||1),0);s.push({name:n,pts:d})}return s},[e]),D=(0,r.useMemo)(()=>{let e=new Map;return s.forEach(s=>{var a;return null==(a=s.activities)?void 0:a.forEach(s=>{var a,r;let i=null!=(r=null==(a=t.find(e=>e.id===s.assigneeId))?void 0:a.role)?r:"Sem fun\xe7\xe3o";e.set(i,(e.get(i)||0)+1)})}),Array.from(e.entries()).map(e=>{let[s,t]=e;return{role:s,value:t}})},[s,t]);return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold",children:"Caaqui ProjectOps (MVP)"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Sistema leve para governan\xe7a de projetos, squads e OKRs."})]}),(0,a.jsx)("button",{onClick:()=>{let a=new Blob([JSON.stringify({boardActivities:e,okrs:s,collaborators:t},null,2)],{type:"application/json"}),r=URL.createObjectURL(a),i=document.createElement("a");i.href=r,i.download="caaqui-projectops-export.json",i.click(),URL.revokeObjectURL(r)},className:"px-3 py-2 rounded-xl border",children:"Exportar"})]}),(0,a.jsx)(N,{}),(0,a.jsxs)("div",{className:"grid md:grid-cols-4 gap-4",children:[(0,a.jsx)(v,{title:"Projetos ativos",value:String(f)}),(0,a.jsx)(v,{title:"No prazo",value:"".concat(w,"%"),subtitle:"Projetos dentro do cronograma"}),(0,a.jsx)(v,{title:"Risco/Aten\xe7\xe3o",value:"".concat(M,"%"),subtitle:"Projetos atrasados ou em risco"}),(0,a.jsx)(v,{title:"Tarefas conclu\xeddas",value:String(p),subtitle:"".concat(y," no board")})]}),(0,a.jsxs)("div",{className:"rounded-2xl border p-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-4",children:"Custos dos Projetos Ativos"}),(0,a.jsxs)("div",{className:"space-y-3",children:[b.filter(e=>"active"===e.status).map(e=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:e.daysRemaining>0?"".concat(e.daysRemaining," dias restantes"):"Atrasado"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-medium",children:["R$ ",e.realCost.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),(0,a.jsxs)("div",{className:"text-xs ".concat(e.budgetVariance>10?"text-red-600":e.budgetVariance>0?"text-yellow-600":"text-green-600"),children:[e.budgetVariance>0?"+":"",e.budgetVariance.toFixed(1),"% do or\xe7amento"]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:["Progresso: ",e.progressPct.toFixed(1),"%"]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(e.isOnTime?e.progressPct>80?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.isOnTime?e.progressPct>80?"No prazo":"Em andamento":"Atrasado"})]})]},e.id)),0===b.filter(e=>"active"===e.status).length&&(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Nenhum projeto ativo no momento."})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"rounded-2xl border p-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Velocidade (pontos/semana)"}),(0,a.jsx)("div",{className:"h-60",children:(0,a.jsx)(l.u,{width:"100%",height:"100%",children:(0,a.jsxs)(n.b,{data:P,children:[(0,a.jsx)(d.d,{strokeDasharray:"3 3"}),(0,a.jsx)(o.W,{dataKey:"name"}),(0,a.jsx)(c.h,{}),(0,a.jsx)(m.m,{}),(0,a.jsx)(x.N,{type:"monotone",dataKey:"pts"})]})})})]}),(0,a.jsxs)("div",{className:"rounded-2xl border p-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Utiliza\xe7\xe3o por fun\xe7\xe3o"}),(0,a.jsx)("div",{className:"h-60",children:(0,a.jsx)(l.u,{width:"100%",height:"100%",children:(0,a.jsxs)(h.E,{data:D,children:[(0,a.jsx)(d.d,{strokeDasharray:"3 3"}),(0,a.jsx)(o.W,{dataKey:"role"}),(0,a.jsx)(c.h,{}),(0,a.jsx)(m.m,{}),(0,a.jsx)(u.y,{dataKey:"value"})]})})})]})]}),(0,a.jsxs)("div",{className:"rounded-2xl border p-4",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Utiliza\xe7\xe3o por pessoa"}),(0,a.jsxs)("div",{className:"space-y-3",children:[t.map(e=>{let{projectAllocations:s}=i.C.getState(),t=new Date,r=s.filter(s=>s.collaboratorId===e.id&&new Date(s.endDate)>t&&new Date(s.startDate)<=t),l=r.reduce((e,s)=>e+s.percentage,0),n=r.length,d=Math.round(l/100*40);return(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:e.position||e.role})]}),(0,a.jsxs)("div",{className:"text-right text-sm",children:[(0,a.jsxs)("div",{className:"font-medium",children:[l,"%"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:[d,"h/semana"]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[n," projeto",1!==n?"s":""," simult\xe2neo",1!==n?"s":""]}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(l>100?"bg-red-100 text-red-800":l>80?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:l>100?"Sobrealocado":l>80?"Alta utiliza\xe7\xe3o":"Dispon\xedvel"})]}),(0,a.jsx)("div",{className:"h-2 bg-gray-200 rounded-xl",children:(0,a.jsx)("div",{className:"h-2 rounded-xl ".concat(l>100?"bg-red-500":l>80?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(Math.min(100,l),"%")}})}),r.length>0&&(0,a.jsx)("div",{className:"mt-2 space-y-1",children:r.map(e=>{let s=j.find(s=>s.id===e.projectId);return(0,a.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,a.jsx)("span",{children:(null==s?void 0:s.name)||"Projeto n\xe3o encontrado"}),(0,a.jsxs)("span",{children:[e.percentage,"%"]})]},e.id)})})]},e.id)}),0===t.length&&(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Nenhum colaborador ainda."})]})]})]})}}}]);